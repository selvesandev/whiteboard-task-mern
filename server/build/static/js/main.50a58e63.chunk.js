(this["webpackJsonpwhiteboard-task-mern"]=this["webpackJsonpwhiteboard-task-mern"]||[]).push([[0],{32:function(e,t,n){},61:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(12),s=n.n(c),o=(n(32),n(5)),i=n(9),u=n(4),l=n(13),d=n(3),p=n.n(d),v=n(8),f=n(11),h=n.n(f);h.a.defaults.baseURL="/api",h.a.defaults.headers.post["Content-Type"]="application/json",h.a.interceptors.response.use((function(e){return e}),(function(e){return e.response&&e.response.data&&e.response.status,Promise.reject(e)}));var j=function(e){var t=e.url,n=e.params;return new Promise((function(e,a){var r={method:"GET",url:t,params:n};return e(h()(r))}))},b=function(e){var t=e.url,n=e.data,a=e.params;return new Promise((function(e,r){var c={method:"POST",url:t,data:n,params:a,headers:{}};return e(h()(c))}))},g=function(e){var t=e.url,n=e.data,a=e.params;return new Promise((function(e,r){var c={method:"PUT",url:t,data:n,params:a,headers:{}};return e(h()(c))}))},O=function(e){var t=e.url,n=e.data,a=e.params,r=void 0===a?{}:a;return new Promise((function(e,a){var c={method:"DELETE",url:t,data:n,params:r,headers:{}};return e(h()(c))}))},m=function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=n.length,r=0;r<e;r++)t+=n.charAt(Math.floor(Math.random()*a));return t},y="CATEOGRY_GENERAL_STATE",x="CATEGORY_TASK_REORDER_STATIC",w="CATEGORY_TASK_UPDATE_STATIC",_="CATEGORY_TASK_DELETE_STATIC",k="CATEGORY_CREATE_STATIC",E="CATEGORY_TASK_STATIC",T="TASK_GENERAL_STATE",C=function(e){var t=e.props,n=e.value,a=e.deep;return{type:y,payload:{props:t,value:n,deep:a}}},S=function(){return function(){var e=Object(v.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t(C({props:"fetching",value:!0})),e.next=4,j({url:"/category"});case 4:n=e.sent,t(C({props:"data",value:n.data.data})),e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),Error(e.t0);case 11:return e.prev=11,t(C({props:"fetching",value:!1})),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})));return function(t){return e.apply(this,arguments)}}()},N=function(e){var t=e.props,n=e.value,a=e.deep;return{type:T,payload:{props:t,value:n,deep:a}}},A=function(e){var t=e.id,n=e.svg_events,a=e.mode,r=void 0===a?"CREATE":a;return function(){var e=Object(v.a)(p.a.mark((function e(a){var c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a(N({props:"saving",value:!0})),e.next=4,g({url:"/task/".concat(t),data:{svg_events:n},params:{mode:r}});case 4:return c=e.sent,a({type:w,payload:{id:t,svg_events:n}}),e.abrupt("return",c);case 9:throw e.prev=9,e.t0=e.catch(0),Error(e.t0);case 12:return e.prev=12,a(N({props:"saving",value:!1})),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,9,12,15]])})));return function(t){return e.apply(this,arguments)}}()},D=n(1),R=function(e){var t=e.height,n=void 0===t?100:t,a=e.width,r=void 0===a?100:a,c=e.color,s=void 0===c?"#fff":c,o=e.isFullScreen,i=void 0!==o&&o;return Object(D.jsxs)("div",{children:[Object(D.jsx)("div",{className:"loader "+(i?"full_screen":""),children:Object(D.jsx)("svg",{style:{width:r,height:n},version:"1.1",id:"L9",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 100 100",enableBackground:"new 0 0 0 0",children:Object(D.jsx)("path",{fill:s,d:"M73,50c0-12.7-10.3-23-23-23S27,37.3,27,50 M30.9,50c0-10.5,8.5-19.1,19.1-19.1S69.1,39.5,69.1,50",children:Object(D.jsx)("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",dur:"1s",from:"0 50 50",to:"360 50 50",repeatCount:"indefinite"})})})}),i?Object(D.jsx)("div",{className:"bg",onClick:function(e){}}):null]})},I=function(e){var t=e.value,n=e.onBlur,a=e.placeholder,r=e.onChange,c=e.loading;return Object(D.jsxs)("div",{className:"input_container",children:[Object(D.jsx)("input",{type:"text",className:"input_element",placeholder:a,autoFocus:!0,onFocus:function(e){e.target.select()},value:t,onBlur:n,onChange:function(e){r&&r(e.target.value)}}),c?Object(D.jsx)(R,{height:40,width:40,color:"#4caf50"}):null]})},P=function(e){var t=e.category,n=e.selectCategory,r=e.children,c=e.mode,s=void 0===c?"edit":c,o=e.onBlur,l=e.onSave,d=Object(a.useState)(null),f=Object(i.a)(d,2),h=f[0],j=f[1],O=Object(a.useState)(""),m=Object(i.a)(O,2),y=m[0],x=m[1],w=Object(u.c)(),_=Object(u.d)((function(e){return e.category}));return Object(a.useEffect)((function(){t&&x(t.name)}),[]),Object(D.jsxs)("section",{children:["add"!==s&&h!==t.id?Object(D.jsx)("h2",{className:"cat_title",onClick:function(){j(t.id),n&&n(t)},children:Object(D.jsx)("span",{children:t.name})}):Object(D.jsx)("form",{onSubmit:function(e){e.preventDefault(),t?w(function(e){var t=e.id,n=e.name;return function(){var e=Object(v.a)(p.a.mark((function e(a){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a(C({props:"saving",value:!0})),e.next=4,g({url:"/category/".concat(t),data:{name:n}});case 4:return e.abrupt("return",e.sent);case 7:throw e.prev=7,e.t0=e.catch(0),Error(e.t0);case 10:return e.prev=10,a(C({props:"saving",value:!1})),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,7,10,13]])})));return function(t){return e.apply(this,arguments)}}()}({id:t._id,name:y})).then((function(e){j(null),w(S()),l&&l()})).catch((function(e){})):w(function(e){var t=e.name;return function(){var e=Object(v.a)(p.a.mark((function e(n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n({type:k,payload:{name:t}}),n(C({props:"saving",value:!0})),e.next=5,b({url:"/category",data:{name:t}});case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(0),Error(e.t0);case 11:return e.prev=11,n(C({props:"saving",value:!1})),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})));return function(t){return e.apply(this,arguments)}}()}({name:y})).then((function(e){w(S()),l&&l()})).catch((function(e){}))},children:Object(D.jsx)(I,{loading:_.saving,onChange:function(e){x(e)},placeholder:"Name your category",onBlur:function(){j(null),o&&o()},value:y})}),r]})};P.proTotype={};var L=n(10),B=new L.EventStream,G=new L.EventStore,U=function(e){var t=e.task,n=e.onUpdate,r=(e.onDelete,e.onDuplicate,Object(u.c)()),c=Object(a.useState)(!1),s=Object(i.a)(c,2),o=s[0],l=s[1];return G.goodEvents=t.svg_events,Object(D.jsxs)("div",{className:"notes n_card ",style:{},children:[Object(D.jsx)(L.Whiteboard,{style:{backgroundColor:"white"},height:150,events:B,eventStore:G}),Object(D.jsxs)("div",{className:"card_action",children:[Object(D.jsx)("a",{href:"/",disabled:o,className:o?"disabled":"",onClick:function(e){e.preventDefault(),t.static||(l(!0),r(A({id:t._id,svg_events:t.svg_events,mode:"DUPLICATE"})).then((function(e){r(S())})).catch((function(e){})).finally((function(){l(!1)})))},children:Object(D.jsx)("i",{className:"far fa-copy "+(o?"rotate_":"")})}),Object(D.jsx)("a",{href:"/",onClick:function(e){e.preventDefault(),t.static||n&&n()},children:Object(D.jsx)("i",{className:"far fa-pen"})}),Object(D.jsx)("a",{href:"/",onClick:function(e){e.preventDefault(),t.static||r(function(e){var t=e.id;return function(){var e=Object(v.a)(p.a.mark((function e(n){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n({type:_,payload:{value:t}}),e.next=4,O({url:"/task/".concat(t)});case 4:return a=e.sent,e.abrupt("return",a);case 8:throw e.prev=8,e.t0=e.catch(0),Error(e.t0);case 11:return e.prev=11,e.finish(11);case 13:case"end":return e.stop()}}),e,null,[[0,8,11,13]])})));return function(t){return e.apply(this,arguments)}}()}({id:t._id})).catch((function(){}))},children:Object(D.jsx)("i",{className:"far fa-trash "})})]}),Object(D.jsx)("div",{className:"overlay"})]})},F=function(e){var t=e.width,n=e.height,a=void 0===n?150:n,r=e.goodEvents,c=e.onStop,s=new L.EventStream,o=new L.EventStore;return o.goodEvents=[],r&&(o.goodEvents=r),s.on("stop",(function(){c&&c(o.goodEvents)})),Object(D.jsx)("div",{children:Object(D.jsx)(L.Whiteboard,{style:{backgroundColor:"white"},height:a,width:t,events:s,eventStore:o})})},M=function(e){var t=e.children,n=e.onClose,a=e.show,r=void 0!==a&&a,c=e.width,s=void 0===c?500:c,o=e.height,i=void 0===o?500:o,u=e.title,l=e.subTitle,d=e.onSave,p=e.loading,v=void 0!==p&&p,f=e.btnText,h=void 0===f?"Create Task":f;return r?Object(D.jsxs)("div",{children:[Object(D.jsxs)("div",{className:"modal",style:{width:s,height:i},children:[Object(D.jsxs)("div",{className:"title",children:[u?Object(D.jsx)("h1",{className:"",children:u}):null,l?Object(D.jsx)("small",{children:l}):null]}),Object(D.jsx)("div",{className:"modal-body",children:t}),Object(D.jsx)("div",{className:"modal-action",children:Object(D.jsxs)("div",{className:"task_act_button",children:[Object(D.jsx)("button",{disabled:v,className:"btn btn-primary ".concat(v?"disabled":""),type:"submit",onClick:function(){d&&d()},children:v?"Saving...":h}),"\xa0\xa0",Object(D.jsx)("button",{type:"button",className:"btn",onClick:function(){n&&n()},children:"Cancel"})]})})]}),Object(D.jsx)("div",{className:"bg",onClick:function(e){e.preventDefault(),n&&n()}})]}):null},Y=[],K=function(e){var t=e.onClose,n=e.height,a=void 0===n?440:n,r=e.category,c=e.show,s=e.mode,o=void 0===s?"CREATE":s,i=e.selectedTask,l=Object(u.c)(),d=Object(u.d)((function(e){return e.task})),f='Add New Task "'.concat(r?r.name:"",'"'),h=null;return i&&(f="CREATE"===o?'Update Task "'.concat(r?r.name:"",'"'):'Duplicate Task "'.concat(r?r.name:"",'"'),h=i.svg_events,Y=i.svg_events),Object(D.jsxs)(M,{btnText:i?"CREATE"===o?"Update Task":"Duplicate Task":"Create Task",loading:d.saving,onSave:function(){Y&&Y.length&&(i?l(A({svg_events:Y,id:i._id,mode:o})).then((function(e){t()})).catch((function(e){console.log(e)})):l(function(e){var t=e.category,n=e.svg_events;return function(){var e=Object(v.a)(p.a.mark((function e(a){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a(N({props:"saving",value:!0})),e.next=4,b({url:"/task",data:{category:t,svg_events:n}});case 4:r=e.sent,a({type:E,payload:{category:t,svg_events:n,id:r.data.data._id}}),e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),Error(e.t0);case 11:return e.prev=11,a(N({props:"saving",value:!1})),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})));return function(t){return e.apply(this,arguments)}}()}({svg_events:Y,category:r._id})).then((function(e){Y=[],t()})).catch((function(e){console.log(e)})))},height:a,subTitle:"Draw on the white board to and create a new task.",title:f,onClose:function(){t&&t()},show:c,children:[Object(D.jsx)(F,{goodEvents:h,onStop:function(e){Y=e},height:220,width:500}),Object(D.jsx)("p",{style:{color:"#999"},children:Object(D.jsx)("small",{children:"Click and move your mouse to start drawing"})})]})},J=function(){var e=Object(u.c)();return Object(D.jsxs)("div",{className:"downloder",children:[Object(D.jsx)("button",{onClick:function(){window.location.href="/api/category/download"},children:"Download"}),Object(D.jsx)("button",{onClick:function(){e(function(){var e=Object(v.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t(C({props:"data",value:[]})),e.next=4,O({url:"/category/flush-record"});case 4:return n=e.sent,t(S()),e.abrupt("return",n);case 9:throw e.prev=9,e.t0=e.catch(0),Error(e.t0);case 12:return e.prev=12,t(C({props:"saving",value:!1})),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,9,12,15]])})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log(e)}))},children:"Flush Records"})]})};var W=function(){var e=Object(a.useState)(null),t=Object(i.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(null),s=Object(i.a)(c,2),d=s[0],f=s[1],h=Object(a.useState)("CREATE"),j=Object(i.a)(h,2),b=j[0],O=j[1],m=Object(a.useState)(!1),y=Object(i.a)(m,2),w=y[0],_=y[1],k=Object(u.c)(),E=Object(u.d)((function(e){return e.category}));return Object(a.useEffect)((function(){k(S()).catch((function(e){}))}),[]),Object(D.jsxs)("div",{className:"App",children:[Object(D.jsx)(l.a,{onDragEnd:function(e){var t=e.destination,n=e.source,a=e.draggableId;t&&(t.droppableId===n.droppableId&&t.index===n.index||k(function(e){var t=e.destination,n=e.id,a=e.source;return function(){var e=Object(v.a)(p.a.mark((function e(r,c){var s,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t!==a){e.next=3;break}return e.abrupt("return");case 3:if(r({type:x,payload:{destination:t,source:a,id:n}}),c().task.ordering){e.next=11;break}return s=c().category.lastSavedOrder,r(N({props:"ordering",value:!0})),e.next=9,g({url:"/task/reorder/".concat(s.id),data:{category:s.destination}}).catch((function(e){console.log(e)}));case 9:return o=e.sent,e.abrupt("return",o);case 11:e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(0),Error(e.t0);case 16:return e.prev=16,r(N({props:"ordering",value:!1})),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[0,13,16,19]])})));return function(t,n){return e.apply(this,arguments)}}()}({destination:t.droppableId,id:a,source:n.droppableId})))},children:E.data.map((function(e,t){return Object(D.jsx)(l.c,{droppableId:String(e._id),children:function(n,a){return Object(D.jsx)("section",Object(o.a)(Object(o.a)({className:"category_iterator "+(a.isDraggingOver?"dragging_over":"")},n.droppableProps),{},{ref:n.innerRef,children:Object(D.jsxs)(P,{category:e,children:[e.tasks?e.tasks.map((function(n,a){return Object(D.jsx)(l.b,{index:a,draggableId:String(n._id),children:function(t,c){return Object(D.jsx)("div",Object(o.a)(Object(o.a)(Object(o.a)({ref:t.innerRef,className:c.isDragging?"is_dragging":""},t.draggableProps),t.dragHandleProps),{},{children:Object(D.jsx)(U,{onUpdate:function(){f(n),r(e)},onDuplicate:function(){f(n),r(e),O("DUPLICATE")},task:n},a)}))}},a+t)})):null,n.placeholder,Object(D.jsxs)("div",{onClick:function(){e.static||(f(null),r(e))},className:"action_add action_add_item",children:[Object(D.jsx)("i",{className:"fas fa-plus-circle"})," \xa0Add New Task.."]})]},t)}))}},t)}))}),w?Object(D.jsx)("section",{className:"category_iterator",children:Object(D.jsx)(P,{onSave:function(){_(!1)},onBlur:function(){_(!1)},mode:"add"})}):Object(D.jsxs)("section",{style:{marginRight:40},onClick:function(){_(!0)},className:"action_add action_add_category",children:[Object(D.jsx)("i",{className:"fas fa-plus-circle"})," \xa0Add New Category"]}),Object(D.jsx)(K,{mode:b,selectedTask:d,show:null!==n,category:n,onClose:function(){r(null),f(null)}}),E.data.length>0?Object(D.jsx)(J,{}):null]})},H=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,62)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))},X=n(6),q=n(27),z={saving:!1,data:[],fetching:!1,lastSavedOrder:{destination:"",id:"",source:""}},Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return t.payload.deep?e[t.payload.props][t.payload.deep]=t.payload.value:e[t.payload.props]=t.payload.value,Object(o.a)({},e);case k:return e.data.push({name:t.payload.name,tasks:[],_id:m(10),static:!0}),Object(o.a)({},e);case x:var n={},a={},r={};return e.data.map((function(e){return t.payload.destination===e._id&&(a=e),t.payload.source===e._id&&(r=e),e.tasks=e.tasks.filter((function(e){if(e._id!==t.payload.id)return e;n=e})),e})),console.log(a,r),e.data.map((function(e){return e._id===t.payload.destination&&e.tasks.push(n),e})),e.lastSavedOrder=t.payload,Object(o.a)({},e);case w:return e.data.map((function(e){return e.tasks=e.tasks.map((function(e){return e._id===t.payload.id&&(e.svg_events=t.payload.svg_events),e})),e})),Object(o.a)({},e);case E:return e.data.map((function(e){if(e._id===t.payload.category){var n=!1,a=m(10);t.payload.id&&(a=t.payload.id,n=!1),e.tasks.push({_id:a,svg_events:t.payload.svg_events,category:t.payload.category,static:n})}return e})),Object(o.a)({},e);case _:var c=null,s=null;try{e.data.map((function(e,n){c=n,e.tasks.map((function(e,n){if(e._id===t.payload.value)throw s=n,Error("stop")}))}))}catch(i){}return null!==c&&null!==s&&e.data[c]&&e.data[c].tasks.splice(s,1),Object(o.a)({},e);default:return Object(o.a)({},e)}},V={saving:!1,data:[],ordering:!1},Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case T:return t.payload.deep?e[t.payload.props][t.payload.deep]=t.payload.value:e[t.payload.props]=t.payload.value,Object(o.a)({},e);default:return Object(o.a)({},e)}},$=Object(X.c)({category:Q,task:Z}),ee=Object(X.e)($,Object(X.d)(Object(X.a)(q.a)));s.a.render(Object(D.jsx)(r.a.StrictMode,{children:Object(D.jsx)(u.a,{store:ee,children:Object(D.jsx)(W,{})})}),document.getElementById("root")),H()}},[[61,1,2]]]);
//# sourceMappingURL=main.50a58e63.chunk.js.map